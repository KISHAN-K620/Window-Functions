            -- EXPLAINATION OF EACH EVERY WINDOW FUNCTION WHICH IS USED IN MYSQL
-- DATABASE WORLD
USE WORLD ;

-- TABLE STUDENT

SELECT * FROM STUDENT ;

-- AGGREGATE FUNCTIONS WITH WINDOW FUNCTIONS

-- PARTITION SUM OF MARKS WITH THE HELP OF WINDOW FUNCTION
SELECT ST_SUBJECT,MARKS,
SUM(MARKS) OVER (PARTITION BY ST_SUBJECT ORDER BY MARKS) AS SUM
FROM STUDENT ;

-- PARTITION COUNT OF MARKS WITH THE HELP OF WINDOW FUNCTION
SELECT ST_SUBJECT,MARKS,
COUNT(MARKS) OVER (PARTITION BY ST_SUBJECT ORDER BY MARKS) AS COUNT
FROM STUDENT ;

-- PARTITION AVERAGE OF MARKS WITH THE HELP OF WINDOW FUNCTION
SELECT ST_SUBJECT,MARKS,
AVG(MARKS) OVER (PARTITION BY ST_SUBJECT ORDER BY MARKS) AS AVERAGE
FROM STUDENT ;

-- PARTITION MIN OF MARKS WITH THE HELP OF WINDOW FUNCTION
SELECT ST_SUBJECT,MARKS,
MIN(MARKS) OVER (PARTITION BY ST_SUBJECT ORDER BY MARKS) AS MIN
FROM STUDENT ;

-- PARTITION MAX OF MARKS WITH THE HELP OF WINDOW FUNCTION
SELECT ST_SUBJECT,MARKS,
MAX(MARKS) OVER (PARTITION BY ST_SUBJECT ORDER BY MARKS) AS MAX
FROM STUDENT ;

-- PARTITION SUM,COUNT,MIN,MAX,MIN,AVERAGE WINDOW FUNCTIONS
SELECT ST_SUBJECT,MARKS,
SUM(MARKS) OVER (PARTITION BY ST_SUBJECT ORDER BY MARKS) AS SUM,
COUNT(MARKS) OVER (PARTITION BY ST_SUBJECT ORDER BY MARKS) AS COUNT,
MIN(MARKS) OVER (PARTITION BY ST_SUBJECT ORDER BY MARKS) AS MIN,
MAX(MARKS) OVER (PARTITION BY ST_SUBJECT ORDER BY MARKS) AS MAX,
AVG(MARKS) OVER (PARTITION BY ST_SUBJECT ORDER BY MARKS) AS AVERAGE
FROM STUDENT ;

-- HERE IS THE END OF AGGREGATE FUNCTION WITH WINDOW FUNCTION

-- NOW LETS START RANKING FUNCTION WITH WINDOW FUNCTION

-- ROW RANK FUNCTION WITH WINDOW FUNCTION
SELECT MARKS,
ROW_NUMBER() OVER (ORDER BY MARKS) AS ROWNUMBER
FROM STUDENT ;

-- RANK FUNCTION WITH WINDOW FUNCTION
SELECT MARKS,
RANK() OVER (ORDER BY MARKS) AS "RANK"
FROM STUDENT

-- DENSE_RANK FUNCTION WITH WINDOW FUNCTION
 SELECT MARKS,
 DENSE_RANK()OVER (ORDER BY MARKS)AS DENSERANK
 FROM STUDENT ;

-- RANK FUNCTION WITH WINDOW FUNCTION
SELECT MARKS,
RANK() OVER (ORDER BY MARKS) AS "RANK"
FROM STUDENT ;

-- PERCENT_RANK FUNCTION WITH WINDOW FUNCTION
SELECT MARKS,
PERCENT_RANK() OVER (ORDER BY MARKS) AS PERCENTRANK
FROM STUDENT ;

-- RANKING FUNCTION ROW_NUMBER,RANK,DENSE_RANK,PERCENT_RANK WINDOW FUNCTIONS
SELECT MARKS,
ROW_NUMBER() OVER (ORDER BY MARKS) AS ROWNUMBER,
RANK() OVER (ORDER BY MARKS) AS "RANK",
DENSE_RANK() OVER (ORDER BY MARKS) AS DENSERANK,
PERCENT_RANK() OVER (ORDER BY MARKS) AS PERCENTRANK
FROM STUDENT ;

-- HERE IS THE END OF RANKING FUNCTIONS

-- STARTING ANALYTIC WINDOW FUNCTIONS

-- FIRST_VALUE ANALYTIC WINDOW FUNCTION
SELECT MARKS,
FIRST_VALUE(MARKS) OVER (ORDER BY MARKS) AS FIRSTVALUE
FROM STUDENT ;

-- LAST_VALUE ANALYTIC WINDOW FUNCTION
SELECT MARKS,
LAST_VALUE(MARKS) OVER (ORDER BY MARKS) AS LASTVALUE
FROM STUDENT ;

-- LEAG ANALYTIC WINDOW FUCNTION
SELECT MARKS,
LEAD(MARKS) OVER (ORDER BY MARKS) AS "LEAG"
FROM STUDENT ;

-- LAG ANALYTIC WINDOW FUNCTION
SELECT MARKS,
LAG(MARKS) OVER (ORDER BY MARKS) AS "LAG"
FROM STUDENT ;

-- ANALYTIC FIRST_VALUE,LAST_VALUE,LEAD,LAG WINDOW FUNCTIONS
SELECT MARKS,
FIRST_VALUE(MARKS) OVER (ORDER BY MARKS) AS FIRSTVALUE,
LAST_VALUE(MARKS) OVER (ORDER BY MARKS) AS LASTVALUE,
LEAD(MARKS) OVER (ORDER BY MARKS) AS "LEAD",
LAG(MARKS) OVER (ORDER BY MARKS) AS "LAG"
FROM STUDENT ;

-- END OF EXPLAINATION OF WINDOW FUNCTIONS

